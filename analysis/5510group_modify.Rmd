---
title: "ETC1010-5510 Project - T11_Wed_skimr"
subtitle: "A Report On The LinkedIn-World Bank Data for Development"
author: "Hanchen Wang 30704456, Hao Li 32041594, Jiaying Zhang 30930685, Mohammed Faizan 31939872, Karan Garg 32106580"
date: "28 April 2021"
output: 
  bookdown::html_document2
keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

#loading packages

library(tidyverse) 
library(plotly)
library(naniar)
library(visdat)
library(bookdown)
library(knitr)
library(ggplot2)
library(lubridate)
library(geosphere)
library(ggmap)
library(ggthemes)


library(here)
library(kableExtra)
library(readxl)
library(readr)
library(tidytext) 
#library(patchwork)
```


3) **For each common skill_category, which industry has the highest penetration rate and what is the change of the common skill penetration rate over the period of time?**



```{r read data}
penetration_raw <- 
  read_csv(here::here('data/2_skill_penetration.csv'))

```


```{r data cleaning}
penetration_clean <- penetration_raw %>% 
  select(!isic_section_index) %>% 
  pivot_wider(names_from = year, 
              values_from = skill_group_penetration_rate) %>% 
  select(skill_group_category:"2019") %>% 
  rename(penetration_rate_2015 = "2015", penetration_rate_2016 = "2016", 
         penetration_rate_2017 = "2017", penetration_rate_2018 = "2018", 
         penetration_rate_2019 = "2019", section_name = isic_section_name) %>% 
  na.omit() %>% 
  mutate(penetration_rate_2015 = as.numeric((unlist(penetration_rate_2015))), 
         penetration_rate_2016 = as.numeric((unlist(penetration_rate_2016))), 
         penetration_rate_2017 = as.numeric((unlist(penetration_rate_2017))), 
         penetration_rate_2018 = as.numeric((unlist(penetration_rate_2018))), 
         penetration_rate_2019 = as.numeric((unlist(penetration_rate_2019)))
         )


```


```{r read cleaned data}
penetration_tidy_1 <- read_csv(here::here('data/2_skill_penetration_clean.csv')) %>% 
  select(!X1)

```


```{r tidy data}
penetration_tidy <- penetration_tidy_1 %>% 
  rename("2015" = penetration_rate_2015, 
         "2016" = penetration_rate_2016, 
         "2017" = penetration_rate_2017, 
         "2018" = penetration_rate_2018, 
         "2019" = penetration_rate_2019) %>% 
  pivot_longer(cols = "2015":"2019", 
               names_to = "year", 
               values_to = "penetration_rate")
```




```{r make function}
Q3_dat2015 <- function(x){
  penetration_tidy %>%
  filter(skill_group_category == x, year == "2015") %>% 
  group_by(industry_name) %>% 
  slice_max(penetration_rate) %>% 
  arrange(desc(penetration_rate)) %>% 
  head(1)
}

Q3_dat2016 <- function(x){
  penetration_tidy %>%
  filter(skill_group_category == x, year == "2016") %>% 
  group_by(industry_name) %>% 
  slice_max(penetration_rate) %>% 
  arrange(desc(penetration_rate)) %>% 
  head(1)
}

Q3_dat2017 <- function(x){
  penetration_tidy %>%
  filter(skill_group_category == x, year == "2017") %>% 
  group_by(industry_name) %>% 
  slice_max(penetration_rate) %>% 
  arrange(desc(penetration_rate)) %>% 
  head(1)
}

Q3_dat2018 <- function(x){
  penetration_tidy %>%
  filter(skill_group_category == x, year == "2018") %>% 
  group_by(industry_name) %>% 
  slice_max(penetration_rate) %>% 
  arrange(desc(penetration_rate)) %>% 
  head(1)
}

Q3_dat2019 <- function(x){
  penetration_tidy %>%
  filter(skill_group_category == x, year == "2019") %>% 
  group_by(industry_name) %>% 
  slice_max(penetration_rate) %>% 
  arrange(desc(penetration_rate)) %>% 
  head(1)
}

```
  


```{r combine the fuction and make the table}

Q3_dat2015_b <- bind_rows(Q3_dat2015("Business Skills"), 
                       Q3_dat2015("Disruptive Tech Skills"), 
                       Q3_dat2015("Soft Skills"), 
                       Q3_dat2015("Specialized Industry Skills"), 
                       Q3_dat2015("Tech Skills")
)

Q3_dat2016_b <- bind_rows(Q3_dat2016("Business Skills"), 
                       Q3_dat2016("Disruptive Tech Skills"), 
                       Q3_dat2016("Soft Skills"), 
                       Q3_dat2016("Specialized Industry Skills"), 
                       Q3_dat2016("Tech Skills")
)

Q3_dat2017_b <- bind_rows(Q3_dat2017("Business Skills"), 
                       Q3_dat2017("Disruptive Tech Skills"), 
                       Q3_dat2017("Soft Skills"), 
                       Q3_dat2017("Specialized Industry Skills"), 
                       Q3_dat2017("Tech Skills")
)

Q3_dat2018_b <- bind_rows(Q3_dat2018("Business Skills"), 
                       Q3_dat2018("Disruptive Tech Skills"), 
                       Q3_dat2018("Soft Skills"), 
                       Q3_dat2018("Specialized Industry Skills"), 
                       Q3_dat2018("Tech Skills")
)

Q3_dat2019_b <- bind_rows(Q3_dat2019("Business Skills"), 
                       Q3_dat2019("Disruptive Tech Skills"), 
                       Q3_dat2019("Soft Skills"), 
                       Q3_dat2019("Specialized Industry Skills"), 
                       Q3_dat2019("Tech Skills")
)

Q3_dat_total <- bind_rows(Q3_dat2015_b, Q3_dat2016_b, Q3_dat2017_b, Q3_dat2018_b, Q3_dat2019_b)

```

# The highest penetration rate for different industry

```{r Q3fig2, fig.width=12, fig.cap="The penetration rate for different industry"}
Q3_dat_fig_2 <- Q3_dat_total %>% ggplot(aes(x = reorder(industry_name, 
                                                        penetration_rate), 
                                            y = penetration_rate, 
                                            fill = industry_name)) + 
  geom_col() + 
  theme_bw() + 
  xlab("Industry section") + 
  ylab("Peneration rate") + 
  scale_y_continuous(breaks=seq(0, 0.3, 0.05)) + 
  facet_wrap(~year, , scales = "free_y",
             ncol = 1, 
             strip.position = "right") 

Q3_dat_fig_2 <- ggplotly(Q3_dat_fig_2)

Q3_dat_fig_2[['x']][['layout']][['annotations']][[2]][['x']] = -0.05 
Q3_dat_fig_2[['x']][['layout']][['annotations']][[1]][['y']] = -0.05
Q3_dat_fig_2 %>% layout(margin = list(l = 75)) 
```

The figure \@ref(fig:Q3fig2) demonstrates that music industry has the highest skill penetration rate at 25% on average, graphic design ranked the second (22%), insurance ranked the third(9%) and writing & editing ranked the third (8%). In addition, aviation & aerospace ranked last in 2015(3%), but were replaced by computer software(5%) in the following years.

# The change of the common skill penetration rate

```{r Q3fig1, fig.width=12, fig.cap="Change for skill peneration rate"}
Q3_dat_fig_1 <- Q3_dat_total %>% ggplot(aes(x = year, 
                                            y = penetration_rate, 
                                            color = skill_group_category, 
                                            group = skill_group_category)) + 
  geom_point() + 
  geom_line() + 
  xlab("Year") + 
  ylab("Skill peneration rate") +
  theme_bw()+
  labs(title = "Change for skill peneration rate") + 
  scale_y_continuous(breaks=seq(0, 0.29, 0.02)) 

 ggplotly(Q3_dat_fig_1)
```
The figure \@ref(fig:Q3fig1) shows that  specialized industry skills ranking first which peaked at 27% in 2017 had fluctuation during the time period while tech skills(2nd, average 22%) keep steadily. And soft skills had a slight climb until exceeding business skills in mid-2017(8%) which had a downwad trend. However, disruptive tech skills ranks the last with 5% on average.



# Conclusion
From the two figures, it is not hard to find that if workers want to enter an industry with a strong professional field, they are often required to master a unique and high threshold skill, such as music and graphic design. While industries with low technical penetration may require more alternative skills due to the fragmentation of the industry. Therefore it is true that the skill penetration rate of an industry is effected by various factors such as the degree of internal segmentation of the industry and the industry itself.

In general, hundreds of skills can be categorized by five common skills. Undoubtedly the specialized industry skills and tech skills has the higher rate which meet the requirements of industry development. Interestingly, With the advent of the era of big data and technology, the importance of many traditional skills like business skill has gradually declined, as shown in the decreasing penetration rate, which means that they are more substitutable in the industry and therefore no longer unique.





